import groovy.json.JsonOutput
import org.apache.http.HttpResponse
import org.apache.http.client.methods.HttpGet
import org.apache.http.impl.client.CloseableHttpClient
import org.apache.http.impl.client.DefaultHttpClient
import org.apache.http.util.EntityUtils
import org.jsoup.Jsoup
import org.jsoup.nodes.Document
pipeline{
    agent none
    stages{
        stage('Example'){
            steps{
                echo 'hello world okk'
            }
        }
        stage('Master Branch'){
            when{
                branch 'master'
            }
            steps{
                echo 'master commit'
            }
        }
        stage('Feature Branch'){
            when{
                branch 'feature'
            }
            steps{
                echo 'feature commit'
            }
        }
        stage('Get'){
            steps{
                script{
                    CloseableHttpClient httpClient = new DefaultHttpClient();
                    url = "https://cloudapi.bytedance.net/faas/services/ttwcxk/invoke/jenkins_apk_builder";
                    HttpGet method1 = new HttpGet(url);
                    method1.setHeader("User-Agent", "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)" +
                            " Chrome/56.0.2924.87 Safari/537.36");
                    String retVal = "";
                    // 转换参数并设置编码格式
                    HttpResponse result1;
                    result1 = httpClient.execute(method1);
                    retVal = EntityUtils.toString(result1.getEntity(), "utf-8");
                    println retVal
                }
            }
        }
    }
}
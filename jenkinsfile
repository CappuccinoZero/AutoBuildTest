import java.io.BufferedReader
import java.io.InputStreamReader
import java.io.OutputStreamWriter
import java.net.URL
import java.net.URLConnection

def sendPostRequest(urlString, paramString) {
    def url = new URL(urlString)
    def conn = url.openConnection()
    conn.setDoOutput(true)
    def writer = new OutputStreamWriter(conn.getOutputStream())

    writer.write(paramString)
    writer.flush()
    String line
    def reader = new BufferedReader(new     InputStreamReader(conn.getInputStream()))
    while ((line = reader.readLine()) != null) {
      println line
    }
    writer.close()
    reader.close()
}
pipeline{
    agent none
    stages{
        stage('Example'){
            steps{
                echo 'hello world okk'
            }
        }
        stage('Master Branch'){
            when{
                branch 'master'
            }
            steps{
                echo 'master commit'
            }
        }
        stage('Feature Branch'){
            when{
                branch 'feature'
            }
            steps{
                echo 'feature commit'
            }
        }
        stage('Get'){
            steps{
                script{
                    sendPostRequest("https://cloudapi.bytedance.net/faas/services/ttwcxk/invoke/jenkins_apk_builder","")
                }
            }
        }
    }
}